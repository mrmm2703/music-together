"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var changeNicknameBtn=$("#change-nickname"),changeProfPicBtn=$("#change-pic"),resetProfPicBtn=$("#reset-pic"),resetAccountBtn=$("#reset-btn"),logoutBtn=$("#logout"),nicknameInput=$("#nickname-input"),fileInput=$("#fileUpload"),fileForm=$("#imgUpload"),bigName=$("#nickname"),smallName=$("#orig-name"),profImages=$(".prof-pic");changeNicknameBtn.click(function(){var e=nicknameInput.val().trim();0!=e.length?$.ajax({url:"api/changeNickname.php?access_token=".concat(accessToken,"&nickname=").concat(e),method:"GET",success:function(){bigName.text(e),smallName.text("("+origName+")"),window.top.postMessage("changeNickname-"+e,"*")},error:function(e){console.error(e),alert("Could not change nickname")}}):alert("Nickname cannot be empty!")}),changeProfPicBtn.click(function(){document.getElementById("fileUpload").click()}),fileForm.on("submit",function(e){e.preventDefault(),fadeInLoading();var o=new FormData(this);$.ajax({url:"api/uploadImg.php",method:"POST",data:o,processData:!1,contentType:!1,success:function(e){if(console.log(e),"Invalid file type"==e)window.top.postMessage("settingsError-Image must be JPEG, GIF or PNG");else if("Server error"==e)window.top.postMessage("settingsError-Internal server error");else if("Too large"==e)window.top.postMessage("settingsError-Image must be under 500KB");else if("Corrupt image"==e)window.top.postMessage("settingsError-Image is corrupt");else{if(console.log(_typeof(e)),".png"!=e.slice(-4)&&".jpg"!=e.slice(-4)&&".gif"!=e.slice(-4)&&".jpeg"!=e.slice(-5))return window.top.postMessage("settingsError-Internal server error"),void fadeOutLoading();profImages.attr("src",e+"?"+(new Date).getTime()),window.top.postMessage("newProfPic-"+e+"?"+(new Date).getTime(),"*")}fadeOutLoading()},error:function(e){console.error(e),window.top.postMessage("settingsError-An unknown error occured."),fadeOutLoading()}})}),fileInput.change(function(e){console.log(fileInput.val()),""!=fileInput.val()&&fileForm.submit()}),resetProfPicBtn.click(function(){fadeInLoading(),$.ajax({url:"api/resetProfPic.php?access_token=".concat(accessToken),method:"GET",success:function(e){profImages.attr("src",e+"?"+(new Date).getTime()),window.top.postMessage("newProfPic-"+e+"?"+(new Date).getTime(),"*"),fadeOutLoading()},error:function(e){console.error(e),alert("Could not reset image"),fadeOutLoading()}})}),resetAccountBtn.click(function(){$.ajax({url:"api/resetAccount.php?access_token=".concat(accessToken),method:"GET",success:function(e){window.top.postMessage("resetAccount","*"),window.top.postMessage("newProfPic-"+e,"*")},error:function(e){console.error(e),alert("Could not reset image")}})}),logoutBtn.click(function(){window.top.postMessage("logout","*")});
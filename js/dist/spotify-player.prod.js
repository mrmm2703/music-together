"use strict";var deviceId,spotifyPlayer,currentTrack,socket=io.connect("https://morahman.me:3000"),urlParams=new URLSearchParams(window.location.search);window.onSpotifyWebPlaybackSDKReady=function(){(spotifyPlayer=new Spotify.Player({name:"Music Together!",getOAuthToken:function(e){e(accessToken)}})).addListener("initialization_error",function(e){var r=e.error;console.error(r)}),spotifyPlayer.addListener("authentication_error",function(e){var r=e.error;console.error(r)}),spotifyPlayer.addListener("account_error",function(e){var r=e.error;console.error(r)}),spotifyPlayer.addListener("playback_error",function(e){var r=e.error;console.error(r),makePopup("Playback error",!0)}),spotifyPlayer.addListener("player_state_changed",function(e){updateMediaSession(),updatePlayer(),updateLikedButton(),e.track_window.current_track.uri!=currentTrack&&(changedSong(),updatePlayer(),addSongChangeMessage(user_id)),e.paused!=paused&&(e.paused?(playbackPause(),socket.emit("pause"),addMessage(user_id,"Paused playback",!0)):(playbackResume(),socket.emit("resume"),addMessage(user_id,"Resumed playback",!0)),paused=!paused)}),spotifyPlayer.addListener("ready",function(e){var r=e.device_id;deviceId=r,console.log("READY! DEVICE ID: "+r),initSocketListeners(),socket.emit("joinedGroup",{group:group_id,name:user_name,prof_pic:user_prof_pic,id:user_id}),"join"==urlParams.get("action")?socket.emit("whereAreWe"):urlParams.has("startSong")?("null"==urlParams.get("startContext")?spotifyPlay(urlParams.get("startSong")):spotifyPlay(urlParams.get("startSong"),urlParams.get("startContext")),makePopup("Web player ready"),fadeOutSearch()):makePopup("Player ready! Play a song to get the party started!")}),spotifyPlayer.addListener("not_ready",function(e){var r=e.device_id;console.log("NOT READY! DEVICE ID: "+r)}),spotifyPlayer.connect()};